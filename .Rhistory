group_by(occupation) %>%
summarise(avg_age = mean(agea, na.rm = T),
avg_BK = mean(BK, na.rm = T)) %>%
drop_na() %>%
ggplot(aes(x = avg_age, y = avg_BK)) +
geom_point() +
geom_text(aes(label = occupation), vjust = 1,
color = "grey",
size = 2) +
geom_smooth(method = "lm", color = "grey",
linetype = "dashed", se = F) +
labs(x = "Average age in occupational group",
y = "Average offshoreability")
ess7 %>%
group_by(occupation) %>%
summarise(avg_age = mean(agea, na.rm = T),
avg_BK = mean(BK, na.rm = T)) %>%
drop_na() %>%
ggplot(aes(x = avg_age, y = avg_BK)) +
geom_point() +
geom_text(aes(label = occupation), vjust = 1,
color = "grey",
size = 4) +
geom_smooth(method = "lm", color = "grey",
linetype = "dashed", se = F) +
labs(x = "Average age in occupational group",
y = "Average offshoreability")
ess7 %>%
group_by(occupation) %>%
summarise(avg_age = mean(agea, na.rm = T),
avg_BK = mean(BK, na.rm = T)) %>%
drop_na() %>%
ggplot(aes(x = avg_age, y = avg_BK)) +
geom_point() +
geom_text(aes(label = occupation), vjust = 1,
color = "grey",
size = 3) +
geom_smooth(method = "lm", color = "grey",
linetype = "dashed", se = F) +
labs(x = "Average age in occupational group",
y = "Average offshoreability")
library(tidyverse)
theme_set(theme_classic())
ess7 <- haven::read_dta("/Users/carloknotz/Documents/Work/Stavanger/Teaching/Statistics/bst290_tutorials_site/ess7.dta")
ess7 %>%
select(idno,cntry,essround,isco08,gndr,agea,trstplt) -> ess7
scores <- haven::read_dta("/Users/carloknotz/Documents/R-code/task.dta")
head(scores)
summary(scores$BK)
scores %>%
arrange(-BK) %>%
head()
scores %>%
arrange(BK) %>%
head()
ess7 %>%
mutate(isco08_scores = as.numeric(isco08)) -> ess7
head(ess7)
ess7 %>%
mutate(isco88 = occupar::isco08to88(isco08_scores)) -> ess7
head(ess7)
ess7 %>%
mutate(isco88_2d = as.numeric(substr(as.character(isco88), 1,2))) -> ess7
ess7 %>%
relocate(idno,cntry,essround,isco08,isco88,isco88_2d) %>%
head()
scores %>%
mutate(isco88_2d = as.numeric(occupation)) -> scores
ess7 %>%
left_join(scores, by = "isco88_2d") -> ess7
ess7 %>%
select(idno,isco08,isco88_2d,BK,RTI_alm_isco_77) %>%
head()
ess7 <- labelled::unlabelled(ess7)
ess7 %>%
group_by(gndr) %>%
summarise(avg_BK = mean(BK, na.rm = T)) %>%
drop_na() %>%
ggplot(aes(x = gndr, y = avg_BK)) +
geom_col()
#| classes: preview-image
ess7 %>%
group_by(occupation) %>%
summarise(avg_age = mean(agea, na.rm = T),
avg_BK = mean(BK, na.rm = T)) %>%
drop_na() %>%
ggplot(aes(x = avg_age, y = avg_BK)) +
geom_point() +
geom_text(aes(label = occupation), vjust = 1,
color = "grey",
size = 3) +
geom_smooth(method = "lm", color = "grey",
linetype = "dashed", se = F) +
labs(x = "Average age in occupational group",
y = "Average offshoreability")
ess7 %>%
ggplot(aes(x = trstplt, y = BK)) +
geom_hex()
ess7 %>%
drop_na(trstplt) %>%
ggplot(aes(x = trstplt, y = BK)) +
geom_hex(binwidth = c(1,.25))
ess7 %>%
drop_na(trstplt) %>%
ggplot(aes(x = trstplt, y = BK)) +
geom_hex(binwidth = c(1,.5))
ess7 %>%
drop_na(trstplt) %>%
ggplot(aes(x = trstplt, y = BK)) +
geom_hex(binwidth = c(1,.75))
ess7 %>%
drop_na(trstplt,BK) %>%
ggplot(aes(x = trstplt, y = BK)) +
geom_hex(binwidth = c(1,.75))
source("~/.active-rstudio-document", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
cpds <- haven::read_dta("/Users/carloknotz/Documents/Data/cpds_2024.dta")
library(tidyverse)
cpds %>% select(country,prop) %>% filter(country%in%c("Australia","New Zealand",year==2018))
cpds %>% select(country,prop) %>% filter(country%in%c("Australia","New Zealand"),year==2018)
cpds %>% select(country,prop) %>% filter(country%in%c("Australia","New Zealand") & year==2018)
cpds %>% select(country,prop) %>% filter(country%in%c("Australia","New Zealand") & year=2018)
cpds %>% select(country,prop) %>% filter(country %in% c("Australia","New Zealand") & year==2018)
cpds %>% select(country,prop) %>% filter(country %in% c("Australia","New Zealand"))
cpds %>% select(country,prop) %>% filter(country %in% c("Australia","New Zealand")) %>% filter(year==2018)
cpds %>% select(country,prop) %>% filter(country %in% c("Australia","New Zealand"))
cpds %>% select(country,prop) %>% filter(country %in% c("Australia","New Zealand")) %>% print(n=126)
library(tidyverse)
set_scheme(scheme_classic())
scheme_set(scheme_classic())
theme_set(scheme_classic())
library(WDI)
install.packages("WDI")
citation("WDI")
source("~/.active-rstudio-document", echo = TRUE)
cpds <- haven::read_dta("CPDS_1960_2022_Update_2024.dta")
cpds <- haven::read_dta("/Users/carloknotz/Documents/Data/cpds_2024.dta")
unique(cpds$country)
library(tidyverse)
cpds %>%
group_by(country) %>%
summarise(start_year = min(year, na.rm = T),
end_year = max(year, na.rm = T))
cpds %>%
group_by(country) %>%
summarise(start_year = min(year, na.rm = T),
end_year = max(year, na.rm = T)) %>%
ggplot(aes(xmin = start_year, xmax = end_year, y = country)) +
geom_linerange()
cpds %>%
group_by(country) %>%
summarise(start_year = min(year, na.rm = T),
end_year = max(year, na.rm = T)) %>%
mutate(year_range = end_year - start_year) %>%
ggplot(aes(xmin = start_year, xmax = end_year,
y = reorder(country, year_range))) +
geom_linerange()
cpds %>%
group_by(country) %>%
summarise(start_year = min(year, na.rm = T),
end_year = max(year, na.rm = T)) %>%
mutate(year_range = end_year - start_year) %>%
ggplot(aes(xmin = start_year, xmax = end_year,
y = reorder(country, year_range))) +
geom_linerange(linewidth = 3) +
labs(y = "")
cpds %>%
group_by(country) %>%
summarise(start_year = min(year, na.rm = T),
end_year = max(year, na.rm = T)) %>%
mutate(year_range = end_year - start_year) %>%
ggplot(aes(xmin = start_year, xmax = end_year,
y = reorder(country, year_range))) +
geom_linerange(linewidth = 3) +
scale_x_continuous(breaks = seq(1960,2020,10)) +
labs(y = "")
cpds %>%
group_by(country) %>%
summarise(start_year = min(year, na.rm = T),
end_year = max(year, na.rm = T)) %>%
mutate(year_range = end_year - start_year) %>%
ggplot(aes(xmin = start_year, xmax = end_year,
y = reorder(country, year_range))) +
geom_linerange(linewidth = 3, color = "grey") +
scale_x_continuous(breaks = seq(1960,2020,10)) +
labs(y = "")
cpds %>%
group_by(country) %>%
summarise(start_year = min(year, na.rm = T),
end_year = max(year, na.rm = T)) %>%
mutate(year_range = end_year - start_year) %>%
ggplot(aes(xmin = start_year, xmax = end_year,
y = reorder(country, year_range))) +
geom_linerange(linewidth = 3, color = "grey15") +
scale_x_continuous(breaks = seq(1960,2020,10)) +
labs(y = "")
cpds %>%
group_by(country) %>%
summarise(start_year = min(year, na.rm = T),
end_year = max(year, na.rm = T)) %>%
mutate(year_range = end_year - start_year) %>%
ggplot(aes(xmin = start_year, xmax = end_year,
y = reorder(country, year_range))) +
geom_linerange(linewidth = 3, color = "grey30") +
scale_x_continuous(breaks = seq(1960,2020,10)) +
labs(y = "")
source("~/.active-rstudio-document", echo = TRUE)
table(cpds$prop)
cpds %>%
group_by(country) %>%
summarise(mprop = mean(prop, na.rm = T))
cpds %>%
group_by(country) %>%
summarise(mprop = mean(prop, na.rm = T)) %>%
ggplot(aes(x = mprop, y = reorder(country, mprop))) +
geom_bar(stat = "identity")
cpds %>%
group_by(country) %>%
summarise(mprop = mean(prop, na.rm = T)) %>%
ggplot(aes(x = mprop, y = reorder(country, mprop))) +
geom_bar(stat = "identity") +
scale_x_continuous(breaks = seq(0,2,1))
cpds %>%
group_by(country) %>%
summarise(mprop = mean(prop, na.rm = T)) %>%
ggplot(aes(x = mprop, y = reorder(country, mprop))) +
geom_bar(stat = "identity") +
geom_text(aes(label = round(mprop, digits = 1))) +
scale_x_continuous(breaks = seq(0,2,1)) +
labs(x = "Proportionality", y = "")
cpds %>%
group_by(country) %>%
summarise(mprop = mean(prop, na.rm = T)) %>%
ggplot(aes(x = mprop, y = reorder(country, mprop))) +
geom_bar(stat = "identity") +
geom_text(aes(label = round(mprop, digits = 1)), hjust = 1) +
scale_x_continuous(breaks = seq(0,2,1)) +
labs(x = "Proportionality", y = "")
cpds %>%
group_by(country) %>%
summarise(mprop = mean(prop, na.rm = T)) %>%
ggplot(aes(x = mprop, y = reorder(country, mprop))) +
geom_bar(stat = "identity") +
geom_text(aes(label = round(mprop, digits = 1)), hjust = -1) +
scale_x_continuous(breaks = seq(0,2,1)) +
labs(x = "Proportionality", y = "")
cpds %>%
group_by(country) %>%
summarise(mprop = mean(prop, na.rm = T)) %>%
ggplot(aes(x = mprop, y = reorder(country, mprop))) +
geom_bar(stat = "identity") +
geom_text(aes(label = round(mprop, digits = 1)), hjust = -.5) +
scale_x_continuous(breaks = seq(0,2,1)) +
labs(x = "Proportionality", y = "")
cpds %>%
filter(country %in% c("New Zealand","Hungary","Italy")) %>%
ggplot(aes(x = year, y = prop)) +
geom_line() +
facet_wrap(~country)
cpds %>%
filter(country %in% c("New Zealand","Hungary","Italy")) %>%
ggplot(aes(x = year, y = prop)) +
geom_col() +
facet_wrap(~country)
cpds %>%
filter(country %in% c("New Zealand","Hungary","Italy")) %>%
ggplot(aes(x = year, y = prop)) +
geom_col(color = "white") +
facet_wrap(~country)
cpds %>%
filter(country %in% c("New Zealand","Hungary","Italy")) %>%
ggplot(aes(x = year, y = prop)) +
geom_line() +
facet_wrap(~country)
cpds %>%
filter(country %in% c("New Zealand","Hungary","Italy")) %>%
ggplot(aes(x = year, y = prop)) +
geom_line() +
geom_point() +
facet_wrap(~country)
cpds %>%
filter(country %in% c("New Zealand","Hungary","Italy")) %>%
ggplot(aes(x = year, y = prop)) +
geom_line() +
geom_point(fill = "orange") +
facet_wrap(~country)
cpds %>%
filter(country %in% c("New Zealand","Hungary","Italy")) %>%
ggplot(aes(x = year, y = prop)) +
geom_line() +
geom_point(color = "orange") +
facet_wrap(~country)
cpds %>%
filter(country %in% c("New Zealand","Hungary","Italy")) %>%
ggplot(aes(x = year, y = prop)) +
geom_line() +
geom_point(color = "orange") +
facet_wrap(~country) +
scale_y_continuous(breaks = seq(0,2,1))
cpds %>%
filter(country %in% c("New Zealand","Hungary","Italy")) %>%
ggplot(aes(x = year, y = prop)) +
geom_line() +
geom_point(color = "orange") +
facet_wrap(~country) +
scale_y_continuous(breaks = seq(0,2,1)) +
scale_x_continuous(breaks = seq(1960,2020,10))
cpds %>%
filter(country %in% c("New Zealand","Hungary","Italy")) %>%
ggplot(aes(x = year, y = prop)) +
geom_line() +
geom_point(color = "orange") +
facet_wrap(~country, nrow = 3) +
scale_y_continuous(breaks = seq(0,2,1)) +
scale_x_continuous(breaks = seq(1960,2020,10))
cpds %>%
mutate(nzl_etal = case_match(country,
"New Zealand" ~ "NZL",
c("Canada","Australia","USA","United Kingdom") ~ "Similar",
.default = "Other")) -> cpds
cpds %>%
filter(year==2018) %>%
ggplot(aes(x = emprot_reg, y = reorder(country, emprot_reg), fill = nzl_etal)) +
geom_col()
cpds %>%
filter(year==2018) %>%
ggplot(aes(x = emprot_reg, y = reorder(country, emprot_reg), fill = nzl_etal)) +
geom_col() +
scale_fill_grey()
cpds %>%
filter(year==2018) %>%
ggplot(aes(x = emprot_reg, y = reorder(country, emprot_reg), fill = nzl_etal)) +
geom_col() +
scale_fill_manual(values = c("NZL" = "cornflowerblue",
"Similar" = "orange",
"Other" = "grey20"))
cpds %>%
filter(year==2018) %>%
ggplot(aes(x = pres, y = reorder(country, emprot_reg), fill = nzl_etal)) +
geom_col() +
scale_fill_manual(values = c("NZL" = "cornflowerblue",
"Similar" = "orange",
"Other" = "grey20"))
cpds %>%
filter(year==2018) %>%
ggplot(aes(x = pres, y = reorder(country, pres), fill = nzl_etal)) +
geom_col() +
scale_fill_manual(values = c("NZL" = "cornflowerblue",
"Similar" = "orange",
"Other" = "grey20"))
cpds %>%
filter(year==2018) %>%
ggplot(aes(x = pres, y = reorder(country, pres), fill = nzl_etal)) +
geom_col() +
geom_text(aes(label = pres, color = nzl_etal)) +
scale_fill_manual(values = c("NZL" = "cornflowerblue",
"Similar" = "orange",
"Other" = "grey20"))
cpds %>%
filter(year==2018) %>%
ggplot(aes(x = pres, y = reorder(country, pres))) +
geom_col() +
geom_text(aes(label = pres, color = nzl_etal)) +
scale_fill_manual(values = c("NZL" = "cornflowerblue",
"Similar" = "orange",
"Other" = "grey20"))
cpds %>%
filter(year==2018) %>%
ggplot(aes(x = pres, y = reorder(country, pres))) +
geom_col() +
geom_text(aes(label = pres, color = nzl_etal), hjust = -.5) +
scale_fill_manual(values = c("NZL" = "cornflowerblue",
"Similar" = "orange",
"Other" = "grey20"))
cpds %>%
filter(year==2018) %>%
ggplot(aes(x = pres, y = reorder(country, pres))) +
geom_col() +
geom_text(aes(label = pres, color = nzl_etal), hjust = -.5) +
scale_color_manual(values = c("NZL" = "cornflowerblue",
"Similar" = "orange",
"Other" = "grey20"))
cpds %>%
filter(year==2018) %>%
ggplot(aes(x = emprot_reg, y = reorder(country, emprot_reg), fill = nzl_etal)) +
geom_col() +
scale_fill_manual(values = c("NZL" = "cornflowerblue",
"Similar" = "orange",
"Other" = "grey20"))
cpds %>%
filter(year==2018) %>%
ggplot(aes(x = socexp_t_pmp, y = reorder(country, socexp_t_pmp), fill = nzl_etal)) +
geom_col() +
scale_fill_manual(values = c("NZL" = "cornflowerblue",
"Similar" = "orange",
"Other" = "grey20")) +
labs(y = "", x = "Spending on social protection (%GDP; public and mandatory private)")
cpds %>%
filter(year==2018) %>%
ggplot(aes(x = socexp_t_pmp, y = reorder(country, socexp_t_pmp), fill = nzl_etal)) +
geom_col() +
geom_text(aes(label = round(socexp_t_pmp, digits = 1)), hjust = -.5) +
scale_fill_manual(values = c("NZL" = "cornflowerblue",
"Similar" = "orange",
"Other" = "grey20")) +
labs(y = "", x = "Spending on social protection (%GDP; public and mandatory private)") +
theme(legend.position = "none")
WDI::WDIsearch("population density")
WDI::WDIsearch("wealth")
WDI::WDIsearch("GDP per capita")
WDI::WDI(indicator = "EN.POP.DNST")
test <- WDI::WDI(indicator = "EN.POP.DNST")
View(test)
test <- WDI::WDI(indicator = "EN.POP.DNST", country = unique(cpds$iso))
cpds %>%
filter(year == 2018) %>%
ggplot(aes(x = prop, y = reorder(country, prop))) +
geom_col() +
geom_text(aes(label = prop, color = nzl_etal), hjust = -.5) +
labs(y = "", x = "Index of proportionality") +
theme(legend.position = "none")
cpds %>%
filter(year == 2018) %>%
ggplot(aes(x = prop, y = reorder(country, prop))) +
geom_col() +
geom_text(aes(label = prop), hjust = -.5) +
labs(y = "", x = "Index of proportionality") +
theme(legend.position = "none")
cpds %>%
filter(year == 2018) %>%
ggplot(aes(x = pres, y = reorder(country, pres))) +
geom_col() +
geom_text(aes(label = prop), hjust = -.5) +
labs(y = "", x = "Index of presidentialism") +
theme(legend.position = "none")
cpds %>%
filter(year == 2018) %>%
ggplot(aes(x = fed, y = reorder(country, fed))) +
geom_col() +
geom_text(aes(label = prop), hjust = -.5) +
labs(y = "", x = "Index of federalism") +
theme(legend.position = "none")
cpds %>%
filter(year == 2018) %>%
ggplot(aes(x = pres, y = reorder(country, pres))) +
geom_col() +
geom_text(aes(label = pres), hjust = -.5) +
labs(y = "", x = "Index of presidentialism") +
theme(legend.position = "none")
cpds %>%
filter(year == 2018) %>%
ggplot(aes(x = fed, y = reorder(country, fed))) +
geom_col() +
geom_text(aes(label = fed), hjust = -.5) +
labs(y = "", x = "Index of federalism") +
theme(legend.position = "none")
cpds %>%
filter(year==2018) %>%
ggplot(aes(x = socexp_t_pmp, y = reorder(country, socexp_t_pmp))) +
geom_col() +
geom_text(aes(label = round(socexp_t_pmp, digits = 1)), hjust = -.5) +
labs(y = "", x = "Spending on social protection (%GDP; public and mandatory private)") +
theme(legend.position = "none")
WDIsearch("GDP per capita")
wealth <- WDI(indicator = "6.0.GDPpc_constant", country = unique(cpds$iso))
wealth <- WDI(indicator = "NY.GDP.PCAP.PP.CD", country = unique(cpds$iso))
unique(wealth$country)
wealth %>%
group_by(country) %>%
summarise(start_year = min(year, na.rm = T),
end_year = max(year, na.rm = T)) %>%
mutate(year_range = end_year - start_year) %>%
ggplot(aes(xmin = start_year, xmax = end_year,
y = reorder(country, year_range))) +
geom_linerange(linewidth = 3, color = "grey30") +
scale_x_continuous(breaks = seq(1960,2020,10)) +
labs(y = "")
wealth %>%
filter(year == 2019) %>%
ggplot(aes(x = NY.GDP.PCAP.PP.CD, y = reorder(country, NY.GDP.PCAP.PP.CD))) +
geom_col() +
geom_text(aes(label = round(NY.GDP.PCAP.PP.CD, digits = 1)), hjust = -.5) +
labs(y = "", x = "GPD per capita, PPP (constant 2021 international $)") +
theme(legend.position = "none")
cpds %>%
filter(year == 2018) %>%
ggplot(aes(x = womenpar, y = reorder(country, womenpar))) +
geom_col() +
geom_text(aes(label = round(womenpar, digits = 1)), hjust = -.5) +
labs(y = "", x = "Female representation in parliament (%)") +
theme(legend.position = "none")
cpds %>%
filter(year == 2018) %>%
ggplot(aes(x = womenpar, y = reorder(country, womenpar))) +
geom_col() +
geom_text(aes(label = round(womenpar, digits = 1)), hjust = -1, color = "white") +
labs(y = "", x = "Female representation in parliament (%)") +
theme(legend.position = "none")
cpds %>%
filter(year == 2018) %>%
ggplot(aes(x = womenpar, y = reorder(country, womenpar))) +
geom_col() +
geom_text(aes(label = round(womenpar, digits = 1)), hjust = 1, color = "white") +
labs(y = "", x = "Female representation in parliament (%)") +
theme(legend.position = "none")
cpds %>%
filter(year == 2018) %>%
ggplot(aes(x = womenpar, y = reorder(country, womenpar))) +
geom_col() +
geom_text(aes(label = round(womenpar, digits = 1)), hjust = 1.5, color = "white") +
labs(y = "", x = "Female representation in parliament (%)") +
theme(legend.position = "none")
