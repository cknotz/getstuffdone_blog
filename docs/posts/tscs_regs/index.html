<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Carlo Knotz">
<meta name="dcterms.date" content="2025-10-10">

<title>Regression analyses with macro-level data – Testing big ideas with simple methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-707d8167ce6003fca903bfe2be84ab7f.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-f93c2b1f3f0577f377aefa4848a86a36.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-5100b8561cd7f6cd8c35657ed6fe7ee7.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/bootstrap/bootstrap-f93c2b1f3f0577f377aefa4848a86a36.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<meta name="quarto:status" content="draft">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner"><div id="quarto-draft-alert" class="alert alert-warning"><i class="bi bi-pencil-square"></i>Draft</div>
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Testing big ideas with simple methods</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About this blog</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Regression analyses with macro-level data</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Macro</div>
                <div class="quarto-category">CPDS</div>
                <div class="quarto-category">Comparing countries</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Carlo Knotz </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 10, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#macro-level-questions-and-analyses-again" id="toc-macro-level-questions-and-analyses-again" class="nav-link active" data-scroll-target="#macro-level-questions-and-analyses-again">Macro-level questions and analyses (again)</a></li>
  <li><a href="#variation-in-tscs-data" id="toc-variation-in-tscs-data" class="nav-link" data-scroll-target="#variation-in-tscs-data">Variation in TSCS data</a>
  <ul>
  <li><a href="#cross-sectional-variation" id="toc-cross-sectional-variation" class="nav-link" data-scroll-target="#cross-sectional-variation">Cross-sectional variation</a></li>
  <li><a href="#longitudinal-variation" id="toc-longitudinal-variation" class="nav-link" data-scroll-target="#longitudinal-variation">Longitudinal variation</a></li>
  </ul></li>
  <li><a href="#simpsons-paradox" id="toc-simpsons-paradox" class="nav-link" data-scroll-target="#simpsons-paradox">Simpson’s Paradox</a></li>
  <li><a href="#fixed--random--and-between-effects-models" id="toc-fixed--random--and-between-effects-models" class="nav-link" data-scroll-target="#fixed--random--and-between-effects-models">Fixed-, random-, and between-effects models</a>
  <ul>
  <li><a href="#naive-or-pooled-regression" id="toc-naive-or-pooled-regression" class="nav-link" data-scroll-target="#naive-or-pooled-regression">Naive or “pooled” regression</a></li>
  <li><a href="#the-between-effects-model" id="toc-the-between-effects-model" class="nav-link" data-scroll-target="#the-between-effects-model">The between-effects model</a></li>
  <li><a href="#the-within--or-fixed-effects-model" id="toc-the-within--or-fixed-effects-model" class="nav-link" data-scroll-target="#the-within--or-fixed-effects-model">The within- or fixed-effects model</a></li>
  <li><a href="#fixed-effects-with-constant-variables" id="toc-fixed-effects-with-constant-variables" class="nav-link" data-scroll-target="#fixed-effects-with-constant-variables">Fixed-effects with constant variables</a></li>
  <li><a href="#which-model-should-i-now-choose" id="toc-which-model-should-i-now-choose" class="nav-link" data-scroll-target="#which-model-should-i-now-choose">Which model should I now choose?</a></li>
  <li><a href="#estimation-issues-panel-corrected-standard-errors" id="toc-estimation-issues-panel-corrected-standard-errors" class="nav-link" data-scroll-target="#estimation-issues-panel-corrected-standard-errors">Estimation issues &amp; <em>panel-corrected standard errors</em></a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">






<section id="macro-level-questions-and-analyses-again" class="level2">
<h2 class="anchored" data-anchor-id="macro-level-questions-and-analyses-again">Macro-level questions and analyses (again)</h2>
<p>This is another post on how to analyze country-level data, adding to the earlier post on how to do descriptive analyses (<a href="https://cknotz.github.io/getstuffdone_blog/posts/compa_countries/">this one</a>) and to the one on merging macro-level data (<a href="https://cknotz.github.io/getstuffdone_blog/posts/merging/">this one</a>). What the earlier posts did not go into is how to do regression analyses with cross-country data, and this is what we are going to look into here.</p>
<p>Regression analyses with cross-country data work in principle like regression analyses with other types of data – you specify a model that relates your dependent variable to one or more predictors and control variables, estimate the correct regression model, and interpret the effects.</p>
<p>What makes macro-level analyses more complicated, however, is that macro-level data usually have a <strong>time dimension</strong>: They cover different countries <em>over some period of time</em>. This can range from a few decades like in the case of the <em>Comparative Political Data Set</em> <span class="citation" data-cites="CPDS24">(<a href="#ref-CPDS24" role="doc-biblioref">Armingeon et al. 2024</a>)</span> to multiple centuries like in the case of the <em>V-Dem</em> dataset <span class="citation" data-cites="Lindbergetal2014">(<a href="#ref-Lindbergetal2014" role="doc-biblioref">Lindberg et al. 2014</a>)</span>. This is also why we call these types of datasets <em>time series cross-sectional</em> (TSCS) data: We have a cross-section of countries that are observed at multiple points in time. Because TSCS data include observations of the same units (countries) over multiple points in time, they are sometimes also called “panel data”. However, this is a bit misleading, because panel data traditionally refer to panel <em>survey</em> data, which cover <em>many</em> respondents (typically 1000 or more) over a few time points (often 3-4). TSCS data, in contrast, usually cover only a moderate number of countries (20-35) over longer periods of time <span class="citation" data-cites="Beck2001">(see also <a href="#ref-Beck2001" role="doc-biblioref">Beck 2001</a>)</span>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>This being said, TSCS and panel data share the fact that they include a time dimension. This brings benefits (we can study changes over time and we simply have more observations to work with), but it also makes the dataset and therefore the analysis more complex. This complexity manifests itself in the fact that the results of analyses with TSCS data often change drastically after seemingly minor changes in model specifications <span class="citation" data-cites="Wilson2007">(<a href="#ref-Wilson2007" role="doc-biblioref">Wilson and Butler 2007</a>)</span> – and this is what can make these analyses so daunting to students.</p>
<p>However, TSCS (and panel) regression analyses do become easier and more predictable and stable if one understands a few core concepts:</p>
<ul>
<li>Cross-sectional and longitudinal variation</li>
<li><a href="https://en.wikipedia.org/wiki/Simpson%27s_paradox">Simpson’s Paradox</a></li>
<li>Fixed- vs.&nbsp;random- vs.&nbsp;between-effects regression models</li>
<li>Integration &amp; cointegration (or, relatedly, unit roots and stationarity/non-stationarity)</li>
</ul>
<p>The last ones, integration and co-integration, are concepts from time series analysis methods <span class="citation" data-cites="Box-Steffensmeieretal2014">(see e.g., <a href="#ref-Box-Steffensmeieretal2014" role="doc-biblioref">J. M. Box-Steffensmeier et al. 2014</a>)</span> and they refer, simply put, to how variables change over time: Some variables change smoothly over time and tend to return to a given stable equilibrium value, while others behave erratically and change in sudden (seemingly random) “fits and starts”. The former are considered “stationary”, the latter are considered to have “unit roots”. There is an older (and very short) article that illustrates the concept of unit roots, integration, and co-integration brilliantly with an analogy of a drunk and her dog <span class="citation" data-cites="Murray1994">(<a href="#ref-Murray1994" role="doc-biblioref">Murray 1994</a>)</span>, and I would refer you to that one for further reading.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>The rest of this post will therefore go over the other three aspects with a focus on the main regression models for TSCS and the ideas behind them. You’ll also learn about <em>panel-corrected standard errors</em> (PCSEs), a key element in (political science) analyses of TSCS data <span class="citation" data-cites="Beck1995">Beck and Katz (<a href="#ref-Beck1996" role="doc-biblioref">1996</a>)</span>. First, however, we will go over the structure of TSCS data and the types of variation they contain. We will use both artificial data and the <em>Comparative Political Data Set</em> <span class="citation" data-cites="CPDS24">(<a href="#ref-CPDS24" role="doc-biblioref">Armingeon et al. 2024</a>)</span> to illustrate the main points.</p>
<p>I should add that there are already other (excellent) introductory explanations of how to work with TSCS data in <code>R</code> by Urdinez &amp; Cruz <span class="citation" data-cites="Urdinez2020">(<a href="#ref-Urdinez2020" role="doc-biblioref">2020, chap. 7</a>)</span> and Heiss <span class="citation" data-cites="Heiss2020">(<a href="#ref-Heiss2020" role="doc-biblioref">2020, chap. 13</a> &amp; 14)</span>, but they lack (in my opinion) a user-friendly and easy conceptual introduction to the ideas behind the main regression models for TSCS and panel data. Working with these models and TSCS data becomes a lot easier once one understands these ideas (and the relatively simple math) behind these regression models.</p>
</section>
<section id="variation-in-tscs-data" class="level2">
<h2 class="anchored" data-anchor-id="variation-in-tscs-data">Variation in TSCS data</h2>
<p>Time series cross-sectional data contain observations of multiple <em>units</em> (usually countries) over some period of <em>time</em> (usually years). This means that this type of data can capture two basic forms of variation <span class="citation" data-cites="Kellstedt2018">(see also <a href="#ref-Kellstedt2018" role="doc-biblioref">Kellstedt and Whitten 2018, chap. 2.3</a>)</span>:</p>
<ul>
<li>Differences between <em>units</em>: Cross-sectional variation</li>
<li>Changes over <em>time</em>: Longitudinal variation</li>
</ul>
<p>To make this more concrete, we can look at some real-life examples from the <em>Comparative Political Data Set</em> [CPDS; <span class="citation" data-cites="CPDS24">Armingeon et al. (<a href="#ref-CPDS24" role="doc-biblioref">2024</a>)</span>] and use the simple data visualizations techniques that were covered in the <a href="https://cknotz.github.io/getstuffdone_blog/posts/compa_countries/">earlier blog post</a>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>())</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>cpds <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_dta</span>(<span class="st">"cpds_2024.dta"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We will focus on two variables from the dataset:</p>
<ul>
<li><code>structur</code>, which measures the “rigidity” of countries’ political instititions, a.k.a., the number of “checks and balances” that make introducing reforms easier or more difficult <span class="citation" data-cites="Huber1993 Immergut1992a Immergut1990 Tsebelis2002">(see also <a href="#ref-Huber1993" role="doc-biblioref">Huber, Ragin, and Stephens 1993</a>; <a href="#ref-Immergut1992a" role="doc-biblioref">Ellen M. Immergut 1992</a>; <a href="#ref-Immergut1990" role="doc-biblioref">Ellen M. Immergut 1990</a>; <a href="#ref-Tsebelis2002" role="doc-biblioref">Tsebelis 2002</a>)</span></li>
<li><code>oldage_pmp</code>, which measures the amount of government spending on old-age pensions in percent of countries’ gross domestic product <span class="citation" data-cites="Adema2009 Castles2007">(see also <a href="#ref-Adema2009" role="doc-biblioref">Adema and Ladaique 2009</a>; <a href="#ref-Castles2007" role="doc-biblioref">Castles and Obinger 2007</a>)</span></li>
</ul>
<section id="cross-sectional-variation" class="level3">
<h3 class="anchored" data-anchor-id="cross-sectional-variation">Cross-sectional variation</h3>
<p>One way to look at cross-sectional variation is to look at countries’ average values on the two variables over the entire period of time for which we have observations.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>cpds <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(iso) <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_cons =</span> <span class="fu">mean</span>(structur, <span class="at">na.rm =</span> T)) <span class="sc">|&gt;</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> avg_cons, <span class="at">y =</span> <span class="fu">reorder</span>(iso, avg_cons))) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> avg_cons),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Constitutional structure (avg.)"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>cpds <span class="sc">|&gt;</span> </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year<span class="sc">&gt;=</span><span class="dv">1980</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(iso) <span class="sc">|&gt;</span> </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_pen =</span> <span class="fu">mean</span>(oldage_pmp, <span class="at">na.rm =</span> T)) <span class="sc">|&gt;</span> </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> avg_pen, <span class="at">y =</span> <span class="fu">reorder</span>(iso, avg_pen))) <span class="sc">+</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> avg_pen),</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Public pension spending (% GDP, avg.)"</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">""</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="fig-csvar" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-csvar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-csvar" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-csvar-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-csvar-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-csvar-1.png" class="lightbox" data-gallery="fig-csvar" title="Figure&nbsp;1&nbsp;(a): Constitutional structure"><img src="index_files/figure-html/fig-csvar-1.png" class="img-fluid figure-img" data-ref-parent="fig-csvar" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-csvar-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Constitutional structure
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-csvar" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-csvar-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-csvar-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-csvar-2.png" class="lightbox" data-gallery="fig-csvar" title="Figure&nbsp;1&nbsp;(b): Public spending on pensions"><img src="index_files/figure-html/fig-csvar-2.png" class="img-fluid figure-img" data-ref-parent="fig-csvar" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-csvar-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Public spending on pensions
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-csvar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Cross-sectional variation
</figcaption>
</figure>
</div>
<p><a href="#fig-csvar" class="quarto-xref">Figure&nbsp;1</a> shows the results. On the left side, you see that countries differ in the “rigidity” of their political institutions. The United States and Switzerland stand out as countries with very rigid constitutions, where introducing reforms is very difficult, and this corresponds to what we know from more qualitative observations <span class="citation" data-cites="Obinger2002 Obama2016">(<a href="#ref-Obinger2002" role="doc-biblioref">Obinger 2002</a>; <a href="#ref-Obama2016" role="doc-biblioref">Obama 2016</a>)</span>. On the other end are a number of countries in different parts of Europe but also Israel, where there are few constraints. This does not mean that these are dictatorships, however, it just means that there are few formal constraints on what a governing majority in parliament can do in day-to-day policymaking.</p>
<p>The other graph on the right shows that countries also differ quite a bit in how much they spend, on average, on old-age pensions. Conservative and southern European countries top the list, while more market-liberal countries like the United States, Canada, or Ireland are at the bottom.</p>
</section>
<section id="longitudinal-variation" class="level3">
<h3 class="anchored" data-anchor-id="longitudinal-variation">Longitudinal variation</h3>
<p>Obviously, by averaging the data by country, we brush away all the finer longitudinal changes over time within the different countries. To visualize this, we can use line graphs that are separated by country, as shown in <a href="#fig-tsvar" class="quarto-xref">Figure&nbsp;2</a>.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>cpds <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(structur) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> structur)) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>iso) <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Constitutional structure"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>cpds <span class="sc">|&gt;</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year<span class="sc">&gt;=</span><span class="dv">1980</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> oldage_pmp)) <span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>iso) <span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Pension spending (%GDP)"</span>) <span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1980</span>,<span class="dv">2020</span>,<span class="dv">20</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div id="fig-tsvar" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tsvar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-tsvar" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-tsvar-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-tsvar-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-tsvar-1.png" class="lightbox" data-gallery="fig-tsvar" title="Figure&nbsp;2&nbsp;(a): Constitutional structure"><img src="index_files/figure-html/fig-tsvar-1.png" class="img-fluid figure-img" data-ref-parent="fig-tsvar" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-tsvar-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Constitutional structure
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-tsvar" style="flex-basis: 100.0%;justify-content: flex-start;">
<div id="fig-tsvar-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-tsvar-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-tsvar-2.png" class="lightbox" data-gallery="fig-tsvar" title="Figure&nbsp;2&nbsp;(b): Public spending on pensions"><img src="index_files/figure-html/fig-tsvar-2.png" class="img-fluid figure-img" data-ref-parent="fig-tsvar" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-tsvar-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Public spending on pensions
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tsvar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Longitudinal variation
</figcaption>
</figure>
</div>
<p>When you now look at the graph showing countries’ constitiutional rgidity, you see that there are barely any changes over time. France is the big exception here since it introduced several constitutional changes over a decade or so, and there have also been changes in Belgium, Croatia, Hungary, Italy, New Zealand, and Sweden – but, overall, there is mainly stability.</p>
<p>This contrasts with the pattern in the other graph that shows the develpment of public pension spending in each country. Many countries experienced significant increases over time (e.g., Greence, Portugal, Italy, Japan, Finland, France, or Switzerland), while spending stayed more constant in other countries (e.g., Poland, Germany, or the Netherlands). In all cases, however, there are small year-to-year changes, which is a clear difference to the completely flat lines in the graph above.</p>
</section>
</section>
<section id="simpsons-paradox" class="level2">
<h2 class="anchored" data-anchor-id="simpsons-paradox">Simpson’s Paradox</h2>
<p>The fact that TSCS data contain both cross-sectional and longitudinal variation makes regression analyses more challenging than when one uses a “simple” cross-sectional dataset like survey data from the <em>European Social Survey</em>.</p>
<div id="fig-simp" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-simp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-simp" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-simp-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-simp-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-simp-1.png" class="lightbox" data-gallery="fig-simp" title="Figure&nbsp;3&nbsp;(a): OLS regression with cross-sectional data"><img src="index_files/figure-html/fig-simp-1.png" class="img-fluid figure-img" data-ref-parent="fig-simp" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-simp-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) OLS regression with cross-sectional data
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-simp" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-simp-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-simp-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-simp-2.png" class="lightbox" data-gallery="fig-simp" title="Figure&nbsp;3&nbsp;(b): Simpson’s Paradox"><img src="index_files/figure-html/fig-simp-2.png" class="img-fluid figure-img" data-ref-parent="fig-simp" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-simp-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Simpson’s Paradox
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: OLS regression &amp; Simpson’s Paradox
</figcaption>
</figure>
</div>
<p>A normal regression model basically just draws a line through the data. The graph on the left in <a href="#fig-simp" class="quarto-xref">Figure&nbsp;3</a> illustrates this with data from the <code>mtcars</code> dataset, where each observation is a car and cars differ in the strength of their engines (measured in horsepower) and in their fuel efficiency (measured in miles-per-gallon). Unsurprisingly, a more powerful engine with more horsepower means less fuel efficiency. In this case, the simple regression model works because the data are purely cross-sectional – there is no time-dimension or other complication.</p>
<p>Now consider what can happen when we deal with a more complex dataset with two dimensions, which is shown in the graph on the right.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> A “naive” OLS regression (indicated with the thick black line) would find that there is a negative relationship between the two variables , <code>x</code> and <code>y</code>. However, <em>within</em> the two groups, the relationship is positive. This positive relationship is only correctly captured by a model that focuses exclusively on the variation within each group and ignores the differences between them (indicated by the two colored lines).</p>
<p>In principle, the “naive” OLS model is not really wrong – there <em>is</em> a negative relationship in the data as a whole. But the “naive” model is misleading, because it does not tell us the whole story. To get to that complete story, we need models that separate the between-group variation (the overall difference between groups A and B) from the within-group variation.</p>
<p>The following section introduces regression models that can achieve this.</p>
</section>
<section id="fixed--random--and-between-effects-models" class="level2">
<h2 class="anchored" data-anchor-id="fixed--random--and-between-effects-models">Fixed-, random-, and between-effects models</h2>
<p>Statisticians have developed three basic regression model specifications for data that contain repeated observations of some group of units over time. Originally, they were developed for <em>panel survey</em> data, where researchers follow a larger (and often representative) sample of people over some period of time (often only a few weeks, months, or years) – i.e., data where we have many units but few time points. The models can in principle also be applied to TSCS data, where we usually have observations for many years but only a few countries – i.e., few units, but many time points <span class="citation" data-cites="Beck2001">(see also <a href="#ref-Beck2001" role="doc-biblioref">Beck 2001, 273</a>)</span>.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p>These models are available in <code>R</code> via the <code>plm</code> package <span class="citation" data-cites="Croissant2008">(<a href="#ref-Croissant2008" role="doc-biblioref">Croissant and Millo 2008</a>)</span>, which you can install from <em>CRAN</em> with <code>install.packages()</code> and load with <code>library()</code>. In addition, we also use <code>texreg</code> <span class="citation" data-cites="Leifeld2013">(<a href="#ref-Leifeld2013" role="doc-biblioref">Leifeld 2013</a>)</span> to tabulate the results of the regression models:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("plm")</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plm)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(texreg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>To illustrate how these models work, we will work with a tiny and artificial example dataset (<code>pandat</code>). This dataset contains only nine observations of three variables (<code>x</code>, <code>y</code>, <code>c</code>) for three groups (A, B, and C, measured with the <code>u</code> variable) at three points in time (1,2,3, measured with the <code>t</code> variable):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pandat</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 5
  u         t     x     c     y
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 A         1   1.4   2     0.6
2 A         2   1.7   2    -0.1
3 A         3   2.1   2    -0.2
4 B         1   2.1   1.5   4.6
5 B         2   2.5   1.5   4.3
6 B         3   2.7   1.5   3.8
7 C         1   1.9   3.5   2.4
8 C         2   2     3.5   2  
9 C         3   2.3   3.5   1.4</code></pre>
</div>
</div>
<p>When we visualize the patterns in the data (see <a href="#fig-pandat" class="quarto-xref">Figure&nbsp;4</a>), we see that this is a textbook case of Simpson’s Paradox: Within each group, there is a negative relationship between x and y over time (time points are indicated as numbers). A naive OLS model, however, would find a positive relationship.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-pandat" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pandat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="index_files/figure-html/fig-pandat-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;4: Relationship between x and y in simulated data"><img src="index_files/figure-html/fig-pandat-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pandat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Relationship between x and y in simulated data
</figcaption>
</figure>
</div>
</div>
</div>
<section id="naive-or-pooled-regression" class="level3">
<h3 class="anchored" data-anchor-id="naive-or-pooled-regression">Naive or “pooled” regression</h3>
<p>The first model specification is the “pooled” model. This model does what we did above: It pools all the different observations together and fits a line to the data. In other words, this model ignores the grouped structure of the data.</p>
<p>We can estimate this model with the <code>plm()</code> function from the <code>plm</code> package. This function works essentially like <code>lm()</code> or <code>glm()</code> with the exception that we also need to specify the structure of the data with the <code>index</code> argument (<code>u</code> designates the groups, <code>t</code> the time points) regardless of whether the model picks it up or not). We also need to specify the type of model we want to estimate (with the <code>model</code> argument):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pooled_plm <span class="ot">&lt;-</span> plm<span class="sc">::</span><span class="fu">plm</span>(y <span class="sc">~</span> x,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"u"</span>,<span class="st">"t"</span>),</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">model =</span> <span class="st">"pooling"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> pandat)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pooled_plm)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pooling Model

Call:
plm::plm(formula = y ~ x, data = pandat, model = "pooling", index = c("u", 
    "t"))

Balanced Panel: n = 3, T = 3, N = 9

Residuals:
    Min.  1st Qu.   Median  3rd Qu.     Max. 
-2.35327 -1.09434  0.13646  0.82619  2.44673 

Coefficients:
            Estimate Std. Error t-value Pr(&gt;|t|)  
(Intercept)  -3.9312     2.8846 -1.3628  0.21515  
x             2.8973     1.3664  2.1204  0.07167 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    26.949
Residual Sum of Squares: 16.409
R-Squared:      0.39111
Adj. R-Squared: 0.30412
F-statistic: 4.49627 on 1 and 7 DF, p-value: 0.071675</code></pre>
</div>
</div>
<p>As expected, the model naively pools the data and captures the positive overall relationship between x and y with a postive (and borderline significant) coefficient. It completely ignores the negative relationship between the groups.</p>
<p>For comparison, we can also estimate a standard OLS model with <code>lm()</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>pooled_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> pandat)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pooled_lm)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x, data = pandat)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.3533 -1.0943  0.1365  0.8262  2.4467 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)   -3.931      2.885  -1.363   0.2152  
x              2.897      1.366   2.120   0.0717 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.531 on 7 degrees of freedom
Multiple R-squared:  0.3911,    Adjusted R-squared:  0.3041 
F-statistic: 4.496 on 1 and 7 DF,  p-value: 0.07167</code></pre>
</div>
</div>
<p>The results are exactly identical. This is easier to see when we put the results side-by-side in a single table:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">screenreg</span>(<span class="fu">list</span>(pooled_plm,pooled_lm),</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">stars =</span> <span class="fl">0.05</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">custom.model.names =</span> <span class="fu">c</span>(<span class="st">"Pooling (plm)"</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Regular OLS"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=======================================
             Pooling (plm)  Regular OLS
---------------------------------------
(Intercept)  -3.93          -3.93      
             (2.88)         (2.88)     
x             2.90           2.90      
             (1.37)         (1.37)     
---------------------------------------
R^2           0.39           0.39      
Adj. R^2      0.30           0.30      
Num. obs.     9              9         
=======================================
* p &lt; 0.05</code></pre>
</div>
</div>
</section>
<section id="the-between-effects-model" class="level3">
<h3 class="anchored" data-anchor-id="the-between-effects-model">The between-effects model</h3>
<p>As explained above, the problem with the pooled model is that naively throws together the cross-sectional and longitudinal variation in the data. We can get better answers by separating the two types of variation, and the first type of model that does this is the between-effects model. As the name suggests, the between-effects model focuses completely on the differences <em>between</em> the units and ignores all longitudinal variation over time.</p>
<p>The between-effects model is also almost embarrasingly simple: All we do is what we did in <a href="#fig-csvar" class="quarto-xref">Figure&nbsp;1</a> above: We calculate average values per unit, which means that we eliminate the time-dimension from the data. Then we use the resulting aggregated data in a regular OLS regression.</p>
<p>To show how this works, we do this first by hand and create an aggregated version of the <code>pandat</code> dataset:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>pandat <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(u) <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_y =</span> <span class="fu">mean</span>(y),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_x =</span> <span class="fu">mean</span>(x)) <span class="ot">-&gt;</span> pan_ag</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>This dataset contains only the positive cross-sectional or between-unit relationship in the data:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pan_ag <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> avg_x, <span class="at">y =</span> avg_y)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> u)) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> F)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>If we use this aggregated dataset in a conventional OLS regression, we find the expected positive (and now significant) relationship:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>be_ols <span class="ot">&lt;-</span> <span class="fu">lm</span>(avg_y <span class="sc">~</span> avg_x,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> pan_ag)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(be_ols)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = avg_y ~ avg_x, data = pan_ag)

Residuals:
       1        2        3 
 0.04708  0.04280 -0.08988 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) -10.1926     0.4664  -21.85   0.0291 *
avg_x         5.9109     0.2224   26.58   0.0239 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1101 on 1 degrees of freedom
Multiple R-squared:  0.9986,    Adjusted R-squared:  0.9972 
F-statistic: 706.4 on 1 and 1 DF,  p-value: 0.02394</code></pre>
</div>
</div>
<p>Now compare this to the <code>between</code> model specification in <code>plm()</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>be_plm <span class="ot">&lt;-</span> plm<span class="sc">::</span><span class="fu">plm</span>(y <span class="sc">~</span> x,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"u"</span>,<span class="st">"t"</span>),</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">model =</span> <span class="st">"between"</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> pandat)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(be_plm)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Between Model

Call:
plm::plm(formula = y ~ x, data = pandat, model = "between", index = c("u", 
    "t"))

Balanced Panel: n = 3, T = 3, N = 9
Observations used in estimation: 3

Residuals:
        A         B         C 
 0.047080  0.042800 -0.089879 

Coefficients:
             Estimate Std. Error t-value Pr(&gt;|t|)  
(Intercept) -10.19260    0.46644 -21.852  0.02911 *
x             5.91088    0.22239  26.578  0.02394 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    8.5785
Residual Sum of Squares: 0.012127
R-Squared:      0.99859
Adj. R-Squared: 0.99717
F-statistic: 706.416 on 1 and 1 DF, p-value: 0.023941</code></pre>
</div>
</div>
<p>The results are again exactly identical:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">screenreg</span>(<span class="fu">list</span>(be_ols,be_plm),</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">stars =</span> <span class="fl">0.05</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">custom.model.names =</span> <span class="fu">c</span>(<span class="st">"OLS with aggregated data"</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Between-effects model (plm)"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
==================================================================
             OLS with aggregated data  Between-effects model (plm)
------------------------------------------------------------------
(Intercept)  -10.19 *                  -10.19 *                   
              (0.47)                    (0.47)                    
avg_x          5.91 *                                             
              (0.22)                                              
x                                        5.91 *                   
                                        (0.22)                    
------------------------------------------------------------------
R^2            1.00                      1.00                     
Adj. R^2       1.00                      1.00                     
Num. obs.      3                         3                        
==================================================================
* p &lt; 0.05</code></pre>
</div>
</div>
</section>
<section id="the-within--or-fixed-effects-model" class="level3">
<h3 class="anchored" data-anchor-id="the-within--or-fixed-effects-model">The within- or fixed-effects model</h3>
<p>As above, aggregating the data is inefficient because we lose all the longitudinal variation. Also, depending on the theory or hypothesis we want to test, we may need to focus on the within-group variation in our analysis. In those cases, the between-effects model (or the pooled model) will not get us very far.</p>
<p>If we want to focus on the within- or longitudinal variation, we can use the third alternative, which is the within-model. It is also known as the fixed-effects (FE) model. This model is, in principle, also very simple. One way to estimate this model is to simply add dummy variables for the different group units to the model (leaving one group out as the baseline). However, this adds extra variables to the model and therefore eats up statistical power that we often want to focus instead on the main effect of interest, here the relationship between <code>x</code> and <code>y</code>.</p>
<p>There is therefore another way to estimate this model, which is to de-mean the data and then estimate a linear regression on the resulting dataset. This means that we calculate average values for each of the variables in the model and then subtract the average from each observation. In a way, de-meaning the data is the opposite to calculating the group averages in the between-effects model.</p>
<p>This de-meaning of the data is a simple operation that we can again do by hand:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>pandat <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(u) <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">avg_x =</span> <span class="fu">mean</span>(x),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">avg_y =</span> <span class="fu">mean</span>(y)) <span class="sc">|&gt;</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff_x =</span> x <span class="sc">-</span> avg_x,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">diff_y =</span> y <span class="sc">-</span> avg_y) <span class="ot">-&gt;</span> pandat</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Then we use the de-meaned data in a conventional OLS regression:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>fe_ols <span class="ot">&lt;-</span> <span class="fu">lm</span>(diff_y <span class="sc">~</span> diff_x,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> pandat)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fe_ols)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = diff_y ~ diff_x, data = pandat)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.24551 -0.08846 -0.02436  0.15769  0.23910 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept) -1.616e-16  6.222e-02   0.000  1.00000   
diff_x      -1.365e+00  2.589e-01  -5.275  0.00115 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1867 on 7 degrees of freedom
Multiple R-squared:  0.799, Adjusted R-squared:  0.7703 
F-statistic: 27.82 on 1 and 7 DF,  p-value: 0.001155</code></pre>
</div>
</div>
<p>Notice that the coefficient on <code>x</code> now switches its sign: It is now <em>negative</em> – which means that the model now captures the negative relationship between <code>x</code> and <code>y</code> <em>within</em> each group.</p>
<p>When using the <code>plm()</code> function, we simply specify <code>within</code> as the model – but we use the original data. <code>plm()</code> takes care of the de-meaning for us:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>fe_plm <span class="ot">&lt;-</span> plm<span class="sc">::</span><span class="fu">plm</span>(y <span class="sc">~</span> x,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"u"</span>,<span class="st">"t"</span>),</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">model =</span> <span class="st">"within"</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> pandat)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fe_plm)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Oneway (individual) effect Within Model

Call:
plm::plm(formula = y ~ x, data = pandat, model = "within", index = c("u", 
    "t"))

Balanced Panel: n = 3, T = 3, N = 9

Residuals:
        1         2         3         4         5         6         7         8 
 0.044872 -0.245513  0.200641 -0.088462  0.157692 -0.069231  0.239103 -0.024359 
        9 
-0.214744 

Coefficients:
  Estimate Std. Error t-value Pr(&gt;|t|)   
x -1.36538    0.30629 -4.4579 0.006654 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    1.2133
Residual Sum of Squares: 0.24391
R-Squared:      0.79898
Adj. R-Squared: 0.67836
F-statistic: 19.8725 on 1 and 5 DF, p-value: 0.0066536</code></pre>
</div>
</div>
<p>If you take a very careful look at the results, you see that the coefficient estimate (<span class="math inline">\(\beta\)</span>) is exactly identical to the one we got in the OLS model on the de-meaned data. However, the standard error and <code>t</code>- and <code>p</code>-values are different!</p>
<p>The reason for this is that we use up some of the information in the data (i.e., <em>degrees of freedom</em>) when we calculate the group-averages in the first step. This information is then technically not available when we we calculate standard errors and <code>p</code>-values.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> The <code>plm()</code> function automatically makes this <em>degree-of-freedom</em> adjustment, but not the naive <code>lm()</code> function, hence the different results.</p>
<p>Now compare this to the “dummy” specification:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>fe_dum <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> u,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> pandat)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fe_dum)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x + u, data = pandat)

Residuals:
       1        2        3        4        5        6        7        8 
 0.04487 -0.24551  0.20064 -0.08846  0.15769 -0.06923  0.23910 -0.02436 
       9 
-0.21474 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   2.4667     0.5460   4.518 0.006296 ** 
x            -1.3654     0.3063  -4.458 0.006654 ** 
uB            5.0891     0.2802  18.165 9.29e-06 ***
uC            2.2885     0.2072  11.043 0.000106 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2209 on 5 degrees of freedom
Multiple R-squared:  0.9909,    Adjusted R-squared:  0.9855 
F-statistic: 182.5 on 3 and 5 DF,  p-value: 1.583e-05</code></pre>
</div>
</div>
<p>Now we have two additional variables in the model, the dummies for groups B and C (group A is omitted and measured with the intercept). If you take a careful look, you will notice that the estimate for the coefficient on <code>x</code> is now exactly identical to the estimate we got from th <code>plm()</code> function. This is because the dummy-specification explicitly adjusts for the degrees of freedom by adding additional coefficients to the model (which use up information in the estimation).</p>
<p>We can again put the results side-by-side to see more clearly where they differ:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">screenreg</span>(<span class="fu">list</span>(fe_ols,fe_plm,fe_dum),</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">stars =</span> <span class="fl">0.05</span>,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">custom.model.names =</span> <span class="fu">c</span>(<span class="st">"Regular OLS (dem. data)"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Fixed-effects (plm)"</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Fixed-effects (dummies)"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
==================================================================================
             Regular OLS (dem. data)  Fixed-effects (plm)  Fixed-effects (dummies)
----------------------------------------------------------------------------------
(Intercept)  -0.00                                          2.47 *                
             (0.06)                                        (0.55)                 
diff_x       -1.37 *                                                              
             (0.26)                                                               
x                                     -1.37 *              -1.37 *                
                                      (0.31)               (0.31)                 
uB                                                          5.09 *                
                                                           (0.28)                 
uC                                                          2.29 *                
                                                           (0.21)                 
----------------------------------------------------------------------------------
R^2           0.80                     0.80                 0.99                  
Adj. R^2      0.77                     0.68                 0.99                  
Num. obs.     9                        9                    9                     
==================================================================================
* p &lt; 0.05</code></pre>
</div>
</div>
<p>Again, the estimates of the coefficient on <code>x</code> are exactly identical across the three models, but the standard error is a bit lower in the first model than in the other two (which are exactly identical). You probably also notice that the within- or fixed-effects model estimated with <code>plm()</code> does not contain an intercept.</p>
<p>In any case, the fixed-effects or within-specification correctly captures the within-variation in the data, meaning the negative relationship between <code>x</code> and <code>y</code> within each group.</p>
</section>
<section id="fixed-effects-with-constant-variables" class="level3">
<h3 class="anchored" data-anchor-id="fixed-effects-with-constant-variables">Fixed-effects with constant variables</h3>
<p>You might now ask why we don’t just always use the fixed-effects (FE) model for anything? One of the problems with the FE model is that it cannot capture the effects of variables that are either constant over time or change only very rarely and slowly – the constitutional constraints variable is one of the textbook examples.</p>
<p>To see why, we can estimate a FE model with the one variable in our practice dataset that does not change over time (<code>c</code>, for “constant”):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>pandat</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 9
  u         t     x     c     y avg_x avg_y  diff_x  diff_y
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 A         1   1.4   2     0.6  1.73  0.1  -0.333   0.5   
2 A         2   1.7   2    -0.1  1.73  0.1  -0.0333 -0.2   
3 A         3   2.1   2    -0.2  1.73  0.1   0.367  -0.3   
4 B         1   2.1   1.5   4.6  2.43  4.23 -0.333   0.367 
5 B         2   2.5   1.5   4.3  2.43  4.23  0.0667  0.0667
6 B         3   2.7   1.5   3.8  2.43  4.23  0.267  -0.433 
7 C         1   1.9   3.5   2.4  2.07  1.93 -0.167   0.467 
8 C         2   2     3.5   2    2.07  1.93 -0.0667  0.0667
9 C         3   2.3   3.5   1.4  2.07  1.93  0.233  -0.533 </code></pre>
</div>
</div>
<p>Notice what happens when we do the de-meaning operation with this variable:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>pandat <span class="sc">|&gt;</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(u) <span class="sc">|&gt;</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">avg_c =</span> <span class="fu">mean</span>(c)) <span class="sc">|&gt;</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff_c =</span> c <span class="sc">-</span> avg_c) <span class="ot">-&gt;</span> pandat</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>pandat <span class="sc">|&gt;</span> </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(u,t,c,avg_c,diff_c)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 5
  u         t     c avg_c diff_c
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 A         1   2     2        0
2 A         2   2     2        0
3 A         3   2     2        0
4 B         1   1.5   1.5      0
5 B         2   1.5   1.5      0
6 B         3   1.5   1.5      0
7 C         1   3.5   3.5      0
8 C         2   3.5   3.5      0
9 C         3   3.5   3.5      0</code></pre>
</div>
</div>
<p>The resulting variable, <code>diff_c</code> (which measures the deviations of each variable from the group-specific means) contains only zeros! This is only logical: The variable does not change over time, so each individual observation is exactly identical to the group-specific mean. When we then subtract the two, we get only zeros.</p>
<p><code>plm()</code> will now simply refuse to estimate the model:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>fe_plm_c <span class="ot">&lt;-</span> <span class="fu">plm</span>(y <span class="sc">~</span> c,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"u"</span>,<span class="st">"t"</span>),</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">model =</span> <span class="st">"within"</span>,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> pandat)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-error">
<pre><code>Error in plm.fit(data, model, effect, random.method, random.models, random.dfcor, : empty model</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fe_plm_c)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-error">
<pre><code>Error: object 'fe_plm_c' not found</code></pre>
</div>
</div>
</section>
<section id="which-model-should-i-now-choose" class="level3">
<h3 class="anchored" data-anchor-id="which-model-should-i-now-choose">Which model should I now choose?</h3>
<p>The main difference between the three regression models we went over is <em>which type of variation</em> they focus on (i.e., how they “slice” the data):</p>
<ul>
<li>The “pooling” model simply pools all the data together and draws a best-fitting line through them. It does not differentiate between between-country and over-time variation and can therefore produce very misleading results (due to Simpson’s Paradox; see above).</li>
<li>The “between-effects” model is simply a regression model that is fitted on country-by-country averages. This eliminates the time-dimension from the data and focuses the analysis exclusively on between-country differences (cross-sectional variation).</li>
<li>The “fixed-effects” model focuses on <em>deviations</em> from the country-by-country averages, which means that it eliminates all cross-sectional variation from the data and focuses the analysis on the <em>longitudinal</em> or <em>over-time</em> variation in the data.</li>
</ul>
<p>Because these models focus on different types of variation, you use them for different types of analyses. As always, <strong>which model you use depends on the theory or hypothesis you want to test</strong>.</p>
<p>First, you might be interested in stable differences between countries or in the effects of variables that rarely or never change over time. Political institutions are the textbook example for the latter (as shown above). They basically never change, which means they are a stable <em>cross-sectional</em> feature of different countries.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> In such cases <strong>when you are interested in stable cross-sectional variation, you should use the between-effects model</strong>. For example, Iversen and Soskice <span class="citation" data-cites="Iversen2006">(<a href="#ref-Iversen2006" role="doc-biblioref">2006</a>)</span> used the between-effects regression model in their study of the effects of electoral systems on government redistribution.</p>
<p>A second scenario is that you are interested in <strong>longitudinal/over-time changes</strong>. For example, an older literature in political science and sociology was interested in how economic globalization (increases in international trade and financial transactions across countries) affects the welfare state <span class="citation" data-cites="Cerny1997 Sassen1996 Iversen2000 Burgoon2001 Garrett2001 Brady2005a">(<a href="#ref-Cerny1997" role="doc-biblioref">Cerny 1997</a>; <a href="#ref-Sassen1996" role="doc-biblioref">Sassen 1996</a>; <a href="#ref-Iversen2000" role="doc-biblioref">Iversen and Cusack 2000</a>; <a href="#ref-Burgoon2001" role="doc-biblioref">Burgoon 2001</a>; <a href="#ref-Garrett2001" role="doc-biblioref">Garrett and Mitchell 2001</a>; <a href="#ref-Brady2005a" role="doc-biblioref">Brady, Beckfield, and Seeleib-Kaiser 2005</a>)</span>. In that case, <strong>the fixed-effects model would the natural choice</strong> because it focuses the analysis on over-time changes (how increased globalization leads to changes in welfare state institutions or outcomes) and removes the effects of stable country differences.</p>
<p>Third, there are some who still prefer the “pooling” model <span class="citation" data-cites="Huber1993 Huber2000 Huber2001">(e.g., <a href="#ref-Huber1993" role="doc-biblioref">Huber, Ragin, and Stephens 1993</a>; <a href="#ref-Huber2000" role="doc-biblioref">Huber and Stephens 2000</a>, <a href="#ref-Huber2001" role="doc-biblioref">2001</a>)</span>, and it can indeed be an appropriate model for some types of analyses. One case would be when you are doing analyses that look at between-country and longitudinal variation <em>simultaneously</em> (e.g., when you are interested in how patterns of change differ between countries). For example, you might be interested in how the effect of globlization on welfare states (longitudinal variation) <em>depends on</em> political institutions (cross-sectional variation).<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> Still, you need to be cautious when you use the “pooling” model <span class="citation" data-cites="Wilson2007">(see also <a href="#ref-Wilson2007" role="doc-biblioref">Wilson and Butler 2007, 104–5</a>)</span>.</p>
</section>
<section id="estimation-issues-panel-corrected-standard-errors" class="level3">
<h3 class="anchored" data-anchor-id="estimation-issues-panel-corrected-standard-errors">Estimation issues &amp; <em>panel-corrected standard errors</em></h3>
<p>Cite: <span class="citation" data-cites="Beck1995">Beck and Katz (<a href="#ref-Beck1995" role="doc-biblioref">1995</a>)</span>, <span class="citation" data-cites="Beck1996">Beck and Katz (<a href="#ref-Beck1996" role="doc-biblioref">1996</a>)</span>, <span class="citation" data-cites="Millo2017">Millo (<a href="#ref-Millo2017" role="doc-biblioref">2017</a>)</span></p>
</section>
</section>
<section id="references" class="level2">




</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Adema2009" class="csl-entry" role="listitem">
Adema, Willem, and Maxime Ladaique. 2009. <span>“How Expensive Is the Welfare State?: Gross and Net Indicators in the <span>OECD Social Expenditure Database (SOCX)</span>.”</span> <em>OECD Social, Employment and Migration Working Papers</em> 92.
</div>
<div id="ref-CPDS24" class="csl-entry" role="listitem">
Armingeon, Klaus, Sarah Engler, Lucas Leemann, and David Weisstanner. 2024. <em>Comparative Political Data Set 1960-2022</em>. Zurich, Lueneburg, &amp; Lucerne: University of Zurich, Leuphana University Lueneburg,; University of Lucerne.
</div>
<div id="ref-Beck2001" class="csl-entry" role="listitem">
Beck, Nathaniel. 2001. <span>“Time-Series-Cross-Section Data: What Have We Learned in the Past Few Years?”</span> <em>Annual Review of Political Science</em> 4: 271–93.
</div>
<div id="ref-Beck2008" class="csl-entry" role="listitem">
———. 2008. <span>“Time-Series Cross-Section Methods.”</span> In <em>The Oxford Handbook of Political Methodology</em>, edited by Janet M. Box-Steffensmeier, Henry E. Brady, and David Collier, 475–93. Oxford: Oxford University Press.
</div>
<div id="ref-Beck2011" class="csl-entry" role="listitem">
———. 2011. <span>“Of Fixed-Effects and Time-Invariant Variables.”</span> <em>Political Analysis</em> 19 (2): 119–22.
</div>
<div id="ref-Becketal2006" class="csl-entry" role="listitem">
Beck, Nathaniel, Kristian Skrede Gleditsch, and Kyle Beardsley. 2006. <span>“Space Is More Than Geography: Using Spatial Econometrics in the Study of Political Economy.”</span> <em>International Studies Quarterly</em> 50 (1): 27–44.
</div>
<div id="ref-Beck1995" class="csl-entry" role="listitem">
Beck, Nathaniel, and Jonathan N. Katz. 1995. <span>“What to Do (and Not Do Do) with Time-Series Cross-Section Data.”</span> <em>American Political Science Review</em> 89 (3): 634–47.
</div>
<div id="ref-Beck1996" class="csl-entry" role="listitem">
———. 1996. <span>“Nuisance Vs. Substance: Specifying and Estimating Time-Series-Cross-Section Models.”</span> <em>Political Analysis</em> 6 (1): 1–36.
</div>
<div id="ref-Beck1998a" class="csl-entry" role="listitem">
Beck, Nathaniel, Jonathan N. Katz, and Richard Tucker. 1998. <span>“Taking Time Seriously: Time-Series-Cross-Section Analysis with a Binary Dependent Variable.”</span> <em>American Journal of Political Science</em> 42 (4): 1260–88.
</div>
<div id="ref-Bonoli2001" class="csl-entry" role="listitem">
Bonoli, Giuliano. 2001. <span>“Political Institutions, Veto Points, and the Process of Welfare State Adaptation.”</span> In <em>The New Politics of the Welfare State</em>, edited by Paul Pierson, 237–64. Oxford: Oxford University Press.
</div>
<div id="ref-Box-Steffensmeieretal2014" class="csl-entry" role="listitem">
Box-Steffensmeier, Janet M., John R. Freeman, Matthew P. Hitt, and Jon C. Pevehouse. 2014. <em>Time Series Analysis for the Social Sciences</em>. Cambridge: Cambridge University Press.
</div>
<div id="ref-Box-Steffensmeier2016" class="csl-entry" role="listitem">
Box-Steffensmeier, Janet, and Agnar Freyr Helgason. 2016. <span>“Introduction to Symposium on Time Series Error Correction Methods in Political Science.”</span> <em>Political Analysis</em> 24 (1): 1–2.
</div>
<div id="ref-Brady2005a" class="csl-entry" role="listitem">
Brady, David, Jason Beckfield, and Martin Seeleib-Kaiser. 2005. <span>“Economic Globalization and the Welfare State in Affluent Democracies, 1975-2001.”</span> <em>American Sociological Review</em> 70 (6): 921–48.
</div>
<div id="ref-Burgoon2001" class="csl-entry" role="listitem">
Burgoon, Brian. 2001. <span>“Globalization and Welfare Compensation: Disentangling the Ties That Bind.”</span> <em>International Organization</em> 55 (3): 509–51.
</div>
<div id="ref-Castles2007" class="csl-entry" role="listitem">
Castles, Francis G., and Herbert Obinger. 2007. <span>“Social Expenditure and the Politics of Redistribution.”</span> <em>Journal of European Social Policy</em> 17 (3): 206–22.
</div>
<div id="ref-Cerny1997" class="csl-entry" role="listitem">
Cerny, Philip G. 1997. <span>“Paradoxes of the Competition State: The Dynamics of Political Globalization.”</span> <em>Government and Opposition</em> 32 (2): 251–74.
</div>
<div id="ref-Croissant2008" class="csl-entry" role="listitem">
Croissant, Yves, and Giovanni Millo. 2008. <span>“Panel Data Econometrics in <span>R</span>: The <span class="nocase">plm</span> Package.”</span> <em>Journal of Statistical Software</em> 27 (2): 1–43.
</div>
<div id="ref-DeBoef2008" class="csl-entry" role="listitem">
De Boef, Suzanna, and Luke Keele. 2008. <span>“Taking Time Seriously.”</span> <em>American Journal of Political Science</em> 52 (1): 184–200.
</div>
<div id="ref-Ennsetal2016" class="csl-entry" role="listitem">
Enns, Peter K, Nathan J. Kelly, Takaaki Masaki, and Patrick C. Wohlfarth. 2016. <span>“Don’t Jettison the General Error Correction Model Just yet: A Practical Guide to Avoiding Spurious Regression with the GECM.”</span> <em>Research &amp; Politics</em> 3 (2): 1–13.
</div>
<div id="ref-Garrett2001" class="csl-entry" role="listitem">
Garrett, Geoffrey, and Deborah Mitchell. 2001. <span>“Globalization, Government Spending and Taxation in the <span>OECD</span>.”</span> <em>European Journal of Political Research</em> 39 (2): 145–77.
</div>
<div id="ref-Grant2016" class="csl-entry" role="listitem">
Grant, Taylor, and Matthew J. Lebo. 2016. <span>“Error Correction Methods with Political Time Series.”</span> <em>Political Analysis</em> 24 (1): 3–30.
</div>
<div id="ref-Heiss2020" class="csl-entry" role="listitem">
Heiss, Florian. 2020. <em>Using <span>R</span> for Introductory Econometrics</em>. 2nd ed. Düsseldorf.
</div>
<div id="ref-Huber1993" class="csl-entry" role="listitem">
Huber, Evelyne, Charles Ragin, and John D. Stephens. 1993. <span>“Social Democracy, <span>Christian</span> Democracy, Constitutional Structure, and the Welfare State.”</span> <em>American Journal of Sociology</em> 99 (3): 711–49.
</div>
<div id="ref-Huber2000" class="csl-entry" role="listitem">
Huber, Evelyne, and John D. Stephens. 2000. <span>“Partisan Governance, Women’s Employment, and the <span>Social Democratic</span> Service State.”</span> <em>American Sociological Review</em> 65 (3): 323–42.
</div>
<div id="ref-Huber2001" class="csl-entry" role="listitem">
———. 2001. <em>Development and Crisis of the Welfare State</em>. Chicago: Chicago University Press.
</div>
<div id="ref-Immergut1990" class="csl-entry" role="listitem">
Immergut, Ellen M. 1990. <span>“Institutions, Veto Points, and Policy Results: A Comparative Analysis of Health Care.”</span> <em>Journal of Public Policy</em> 10 (4): 391–416.
</div>
<div id="ref-Immergut1992a" class="csl-entry" role="listitem">
Immergut, Ellen M. 1992. <em>Health Politics: Interests and Institutions in Western Europe</em>. Cambridge: Cambridge University Press.
</div>
<div id="ref-Iversen2000" class="csl-entry" role="listitem">
Iversen, Torben, and Thomas R. Cusack. 2000. <span>“The Causes of Welfare State Expansion: Deindustrialization or Globalization?”</span> <em>World Politics</em> 52 (3): 313–49.
</div>
<div id="ref-Iversen2006" class="csl-entry" role="listitem">
Iversen, Torben, and David Soskice. 2006. <span>“Electoral Institutions and the Politics of Coalitions: Why Some Democracies Redistribute More Than Others.”</span> <em>American Political Science Review</em> 100 (2): 165–81.
</div>
<div id="ref-Kellstedt2018" class="csl-entry" role="listitem">
Kellstedt, Paul M, and Guy D Whitten. 2018. <em>The Fundamentals of Political Science Research</em>. Cambridge: Cambridge University Press.
</div>
<div id="ref-Lebo2017" class="csl-entry" role="listitem">
Lebo, Matthew J., and Patrick W. Kraft. 2017. <span>“The General Error Correction Model in Practice.”</span> <em>Research &amp; Politics</em> 4 (2): 1–13.
</div>
<div id="ref-Leifeld2013" class="csl-entry" role="listitem">
Leifeld, Philip. 2013. <span>“Texreg: Conversion of Statistical Model Output in r to LATEX and HTML Tables.”</span> <em>Journal of Statistical Software</em> 55 (8): 1–24.
</div>
<div id="ref-Lindbergetal2014" class="csl-entry" role="listitem">
Lindberg, Staffan I, Michael Coppedge, John Gerring, and Jan Teorell. 2014. <span>“<span>V-Dem</span>: A New Way to Measure Democracy.”</span> <em>Journal of Democracy</em> 25 (3): 159–69.
</div>
<div id="ref-Millo2017" class="csl-entry" role="listitem">
Millo, Giovanni. 2017. <span>“Robust Standard Error Estimators for Panel Models: A Unifying Approach.”</span> <em>Journal of Statistical Software</em> 82: 1–27.
</div>
<div id="ref-Murray1994" class="csl-entry" role="listitem">
Murray, Michael P. 1994. <span>“A Drunk and Her Dog: An Illustration of Cointegration and Error Correction.”</span> <em>The American Statistician</em> 48 (1): 37–39.
</div>
<div id="ref-Obama2016" class="csl-entry" role="listitem">
Obama, Barack. 2016. <span>“<span>United States</span> Health Care Reform. Progress to Date and Next Steps.”</span> <em>Journal of the American Medical Association</em> 316 (5): 525–32.
</div>
<div id="ref-Obinger2002" class="csl-entry" role="listitem">
Obinger, Herbert. 2002. <span>“<span class="nocase">Föderalismus und wohlfahrtsstaatliche Entwicklung. Österreich und die Schweiz im Vergleich</span>.”</span> <em>Politische Vierteljahresschrift</em> 43 (2): 235–71.
</div>
<div id="ref-Plumpertroeger2007" class="csl-entry" role="listitem">
Plümper, Thomas, and Vera E. Troeger. 2007. <span>“Efficient Estimation of Time-Invariant and Rarely Changing Variables in Finite Sample Panel Analysis with Unit Fixed Effects.”</span> <em>Political Analysis</em> 15 (2): 124–39.
</div>
<div id="ref-Plumperetal2005" class="csl-entry" role="listitem">
Plümper, Thomas, Vera E. Troeger, and Philip Manow. 2005. <span>“Panel Data Analysis in Comparative Politics: Linking Method to Theory.”</span> <em>European Journal of Political Research</em> 44 (2): 327–254.
</div>
<div id="ref-Sassen1996" class="csl-entry" role="listitem">
Sassen, Saskia. 1996. <em>Losing Control?: Sovereignty in the Age of Globalization</em>. New York: Columbia University Press.
</div>
<div id="ref-Stimson1985" class="csl-entry" role="listitem">
Stimson, James A. 1985. <span>“Regression in Space and Time: A Statistical Essay.”</span> <em>American Journal of Political Science</em> 29 (4): 914–47.
</div>
<div id="ref-Swank2001" class="csl-entry" role="listitem">
Swank, Duane. 2001. <span>“Political Institutions and Welfare State Restructuring: The Impact of Institutions on Social Policy Change in Developed Democracies.”</span> In <em>The New Politics of the Welfare State</em>, edited by Paul Pierson, 197–237. Oxford: Oxford University Press.
</div>
<div id="ref-Tsebelis2002" class="csl-entry" role="listitem">
Tsebelis, George. 2002. <em>Veto Players: How Political Institutions Work</em>. Princeton: Princeton University Press.
</div>
<div id="ref-Urdinez2020" class="csl-entry" role="listitem">
Urdinez, Francisco, and Andres Cruz. 2020. <em>R for Political Data Science: A Practical Guide</em>. Boca Raton; others: CRC Press.
</div>
<div id="ref-Wilson2007" class="csl-entry" role="listitem">
Wilson, Sven E., and Daniel M. Butler. 2007. <span>“A Lot More to Do: The Sensitivity of Time-Series Cross-Section Analyses to Simple Alternative Specifications.”</span> <em>Political Analysis</em> 15 (2): 101–23.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The discussion among political science methodologists on how to correctly analyze TSCS data was strongly based on techniques for panel data analysis <span class="citation" data-cites="Beck2001 Beck1995 Beck1996 Beck2011 Beck1998a Becketal2006 Beck2008 Beck2011 Stimson1985 Plumperetal2005 Plumpertroeger2007 DeBoef2008 Wilson2007">(see <a href="#ref-Beck2001" role="doc-biblioref">Beck 2001</a>, <a href="#ref-Beck2011" role="doc-biblioref">2011</a>, <a href="#ref-Beck2008" role="doc-biblioref">2008</a>, <a href="#ref-Beck2011" role="doc-biblioref">2011</a>; <a href="#ref-Beck1995" role="doc-biblioref">Beck and Katz 1995</a>, <a href="#ref-Beck1996" role="doc-biblioref">1996</a>; <a href="#ref-Beck1998a" role="doc-biblioref">Beck, Katz, and Tucker 1998</a>; <a href="#ref-Becketal2006" role="doc-biblioref">Beck, Gleditsch, and Beardsley 2006</a>; <a href="#ref-Stimson1985" role="doc-biblioref">Stimson 1985</a>; <a href="#ref-Plumperetal2005" role="doc-biblioref">Plümper, Troeger, and Manow 2005</a>; <a href="#ref-Plumpertroeger2007" role="doc-biblioref">Plümper and Troeger 2007</a>; <a href="#ref-DeBoef2008" role="doc-biblioref">De Boef and Keele 2008</a>; <a href="#ref-Wilson2007" role="doc-biblioref">Wilson and Butler 2007, Kittel1999, Kittel2005</a>)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>De Doef &amp; Keele <span class="citation" data-cites="DeBoef2008">(<a href="#ref-DeBoef2008" role="doc-biblioref">2008</a>)</span> and Beck &amp; Katz <span class="citation" data-cites="Beck2011">(<a href="#ref-Beck2011" role="doc-biblioref">2011</a>)</span> show how you can deal with non-stationary variables in a regression analysis <span class="citation" data-cites="Box-Steffensmeier2016 Ennsetal2016 Grant2016 Lebo2017">(see also <a href="#ref-Box-Steffensmeier2016" role="doc-biblioref">J. Box-Steffensmeier and Helgason 2016</a>; <a href="#ref-Ennsetal2016" role="doc-biblioref">Enns et al. 2016</a>; <a href="#ref-Grant2016" role="doc-biblioref">Grant and Lebo 2016</a>; <a href="#ref-Lebo2017" role="doc-biblioref">Lebo and Kraft 2017</a>)</span>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>I saved the dataset as <code>cpds_2024.dta</code>. You might have saved it under a different name, in which case you obviously need to adjust that in your code.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>I used <em>ChatGPT</em> to generate this graph.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>The main complicating factor is that TSCS data also have many of the characteristics of longer time series, meaning trends and the above-mentioned degrees of stationarity or integration. This means that analysts also have to think about how to model these features of the data <span class="citation" data-cites="DeBoef2008">Beck (<a href="#ref-Beck2011" role="doc-biblioref">2011</a>)</span>. This is less of a problem when working with “shorter” panel data.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>You might remember that we make a similar adjustment when we calculate the standard deviation of a variable, where we also “use up” information in the first step by calculating the variable’s mean <span class="citation" data-cites="Kellstedt2018">(<a href="#ref-Kellstedt2018" role="doc-biblioref">Kellstedt and Whitten 2018, 137</a>)</span>.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>As Wilson and Butler <span class="citation" data-cites="Wilson2007">(<a href="#ref-Wilson2007" role="doc-biblioref">2007, 108</a>)</span> point out, the between-effects is in these cases an “honest” model because it does not artificially inflate the number of observations in your dataset.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>See e.g., <span class="citation" data-cites="Bonoli2001">Bonoli (<a href="#ref-Bonoli2001" role="doc-biblioref">2001</a>)</span> or <span class="citation" data-cites="Swank2001">Swank (<a href="#ref-Swank2001" role="doc-biblioref">2001</a>)</span>.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>